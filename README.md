# 音ゲー

## 実行環境の必要条件
* python >= 3.10
* pygame >= 2.1

## ゲームの概要
* シャイニングスターというの楽曲に合わせてプレイできる、4レーン形式の音楽ゲームです。
* 参考URL：[魔王魂](https://maou.audio/14_shining_star/)

## ゲームの遊び方
* A,S,D,Fのキーがそれぞれ左から1〜4番目のレーンに対応しています。
* 画面上部から落下してくるノーツが、画面下部の判定ラインに重なるタイミングで対応するキーを押してください。
* タイミングの良さに応じて PERFECT, GOOD の判定が出ます。タイミングを外すと MISS, 見逃すと TOO LATE になります。

## ゲームの実装
### 共通基本機能
* 背景画像の描画
* Pygameウィンドウの表示
* 音源（BGM）の再生
* レーンと判定ラインの描画
* スコア、コンボ数の表示

### 分担追加機能
* ノーツ表示（担当：吉田）：`create_beatmap.py`を実行することで、音楽に合わせてキーを押し、ノーツのタイミングを記録できるので、記録されたデータは`beatmap.csv`として保存されます。
* 判定表示（担当：吉田）：PERFECT/GOOD/MISS/TOO LATEの4種類の判定を実装し、それぞれでスコアやコンボ数が変動します。
* 画面遷移（担当：島田）:ゲーム起動時タイトル画面表示し、spaceでゲームを開始する。ノーツがすべて生成され、画面からノーツがなくなったら曲を止めリザルト画面へ移動する。リザルト画面を表示し、Rキーでタイトルへ移動。（繰り返し）
* 各判定（担当：島田）:キーが押されたとき、ジャッジラインから±15px 以内でperfect、15px ～ 30px の範囲でgood、それ以上ズレるか判定タイミングを過ぎるとmissになる。
* 判定強化（担当：佐藤）:コンボが10の倍数（例：10、20、30コンボなど）に到達すると、約5秒間の「判定強化」が発動します。この間はPERFECT! 判定の範囲が広がり、ノーツをヒットしやすくなるため、高得点獲得の大きなチャンスです。
* フィーバー演出（担当：佐藤）:コンボが10以上を維持している間、「フィーバーモード」に突入！画面全体が特別な光のエフェクトに包まれます。フィーバー中は、ノーツヒット時のスコアにボーナスが加算され、さらなるスコアアップが狙えます。コンボを繋げてフィーバー状態を維持しましょう！
* HP回復（担当：佐藤）:コンボが3の倍数（例：3、6、9コンボなど）になるたびに、HPが10ポイント回復します。これにより、ゲームオーバーのリスクを減らし、より長くプレイを継続してスコアを伸ばすことが可能になります。
* 背景の描画（担当：戸倉）：エフェクト、SE実装
* ロングノーツの生成(担当:田中):`create_beatmap.py`でノーツを記録する際に対応したキー(a,s,d,f)を押している時間を記録できるようになり、ロングノーツが作成される。
* ゲームのロングノーツ対応(担当:田中):キーを押している間に表示される灰色の四角を作成し衝突しているかどうかで判定を行う。MISSとTOO LATE以外の判定されてからの一瞬はMISSの判定は行われない。


### ToDo
- [ ] 音源のノーツの判定確認
- [ ] ゲーム本体(`rhythm_game.py`)は、起動時に`beatmap.csv`を自動で読み込み、その内容に基づいてノーツを生成
- [✓] ロングノーツに対応したキーを押し続けるとmissが発生せずにロングノーツが消える機能
- [✓] create_beatmap.pyからロングノーツを作成する機能
- [] スキル発動(HP回復)→3の倍数ごとにHPを10回復する機能を実装
- [] スキル発動(判定強化)→5の倍数ごとにTO LATEとGood判定の際に数秒間perfect判定になるよう実装
- [] スキル発動(フィーバー演出)→10(仮)combo以上が続くと画面が点滅
- [] タイトル、リザルト画面の背景の追加

### メモ
 ```bash
   pip install pygame
* 背景画像の描画
* キーを押している間、判定用の四角が描画される
* A,S,D,Fキーを用いて、落ちてくるノーツにタイミングよくキーを押す。
* 30コンボ以上で、HP回復、判定強化、フィーバー発動
